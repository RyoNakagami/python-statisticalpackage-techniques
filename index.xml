<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>pytest techniques for regmonkeys</title>
<link>https://ryonakagami.github.io/python-statisticalpackage-techniques/</link>
<atom:link href="https://ryonakagami.github.io/python-statisticalpackage-techniques/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Sun, 10 Nov 2024 15:00:00 GMT</lastBuildDate>
<item>
  <title>はじめてのpytest</title>
  <dc:creator>Ryo Nakagami</dc:creator>
  <link>https://ryonakagami.github.io/python-statisticalpackage-techniques/posts/pytest101/chapter_header.html</link>
  <description><![CDATA[ 




<section id="assert文" class="level2">
<h2 class="anchored" data-anchor-id="assert文"><code>assert</code>文</h2>
<p><code>pytest</code>を用いたunit testの基本構文を理解するために以下のコードを見てみます．</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> test_passing():</span>
<span id="cb1-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<p><code>assert</code>文はテストの成否を判断するPythonの組み込みコマンドです．<code>assert</code>以下が<code>False</code>と評価されると，<code>AssertionError</code>を発生させます．</p>
<p><code>test_passing</code>という関数の名前は<code>test_</code>から始まってますが，<code>pytest</code>は<code>test_</code>で始まる関数をテスト関数として検出しテストを実行します．</p>
<div id="exm-pytest101" class="custom_problem theorem example">
<p><span class="theorem-title"><strong>Example 1</strong></span> <strong>: test_script_001.py</strong> <br></p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> test_passing():</span>
<span id="cb2-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-3"></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> test_passing2():</span>
<span id="cb2-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb2-7"></span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> nottest_passing():</span>
<span id="cb2-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<p>というpytest用のファイルを用意します．これを実行すると</p>
<div id="fed8d211" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>bash</span>
<span id="cb3-2">pytest <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>v .<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pytest_scripts<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>test_script_001.py</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>============================= test session starts ==============================
platform linux -- Python 3.11.8, pytest-8.3.3, pluggy-1.5.0 -- /home/ryo_billiken/Desktop/gh_pages_repo/python-statisticalpackage-techniques/.venv/bin/python
cachedir: .pytest_cache
rootdir: /home/ryo_billiken/Desktop/gh_pages_repo/python-statisticalpackage-techniques
configfile: pyproject.toml
plugins: anyio-4.6.2.post1
collecting ... collected 2 items

pytest_scripts/test_script_001.py::test_passing PASSED                   [ 50%]
pytest_scripts/test_script_001.py::test_passing2 PASSED                  [100%]

============================== 2 passed in 0.01s ===============================</code></pre>
</div>
</div>
<p>上記の例では，</p>
<ul>
<li><code>collecting ... collected 2 items</code>よりテスト関数が2つ検出された</li>
<li><code>test_passing</code>, <code>test_passing2</code> が問題なくテストパスした</li>
</ul>
<p>という情報が表示されています．</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pytest</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span> ./pytest_scripts/test_script_002.py</span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">=============================</span> test session starts ==============================</span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">platform</span> linux <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--</span> Python 3.11.8, pytest-8.3.3, pluggy-1.5.0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--</span> /home/ryo_billiken/Desktop/gh_pages_repo/python-statisticalpackage-techniques/.venv/bin/python</span>
<span id="cb6-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">cachedir:</span> .pytest_cache</span>
<span id="cb6-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">rootdir:</span> /home/ryo_billiken/Desktop/gh_pages_repo/python-statisticalpackage-techniques</span>
<span id="cb6-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">configfile:</span> pyproject.toml</span>
<span id="cb6-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">plugins:</span> anyio-4.6.2.post1</span>
<span id="cb6-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">collecting</span> ... collected 1 item</span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pytest_scripts/test_script_002.py::test_failing</span> FAILED                   <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">100%</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb6-10"></span>
<span id="cb6-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">===================================</span> FAILURES ===================================</span>
<span id="cb6-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">_________________________________</span> test_failing _________________________________</span>
<span id="cb6-13"></span>
<span id="cb6-14">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">def</span> test_failing<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb6-15"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>       assert <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1,</span> 2<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">==</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1,</span> 1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">E</span>       AssertionError: assert <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1,</span> 2<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">==</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1,</span> 1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">E</span>         </span>
<span id="cb6-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">E</span>         At index 1 diff: 2 != 1</span>
<span id="cb6-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">E</span>         </span>
<span id="cb6-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">E</span>         Full diff:</span>
<span id="cb6-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">E</span>           <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb6-22"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">E</span>               1,</span>
<span id="cb6-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">E</span>         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span>     1,...</span>
<span id="cb6-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">E</span>         </span>
<span id="cb6-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">E</span>         ...Full output truncated <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">4</span> lines hidden<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">,</span> use <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-vv'</span> to show</span>
<span id="cb6-26"></span>
<span id="cb6-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pytest_scripts/test_script_002.py:2:</span> AssertionError</span>
<span id="cb6-28"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">===========================</span> short test summary info ============================</span>
<span id="cb6-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FAILED</span> pytest_scripts/test_script_002.py::test_failing <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span> AssertionError: assert <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1,</span> 2<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">==</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1,</span> 1<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb6-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">==============================</span> 1 failed in 0.04s ===============================</span></code></pre></div>
</div>


</section>

 ]]></description>
  <guid>https://ryonakagami.github.io/python-statisticalpackage-techniques/posts/pytest101/chapter_header.html</guid>
  <pubDate>Sun, 10 Nov 2024 15:00:00 GMT</pubDate>
</item>
</channel>
</rss>
